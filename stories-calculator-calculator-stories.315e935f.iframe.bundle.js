(self.webpackChunkuap_assessment=self.webpackChunkuap_assessment||[]).push([[432],{"./src/app/tool/application/presentation/calculator/calculator.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".calculator-wrapper {\n  position: fixed;\n  z-index: 1000;\n  -webkit-user-select: none;\n          user-select: none;\n  transition: opacity 0.3s ease;\n  box-shadow: 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);\n  transition: box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);\n  border-radius: 10px;\n  width: 250px;\n}\n@media screen and (max-width: 1279.98px) {\n  .calculator-wrapper:not(.visible) {\n    box-shadow: 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12);\n  }\n  .calculator-wrapper:not(.visible) .calculator-content {\n    display: none;\n  }\n}\n\n.calculator {\n  border-radius: 10px;\n}\n\n.calculator-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.3rem 1rem;\n  pointer-events: none;\n}\n.calculator-header h3 {\n  margin: 0 auto 0 0.3rem;\n}\n.calculator-header .toggle-btn {\n  visibility: hidden;\n}\n@media screen and (max-width: 1279.98px) {\n  .calculator-header {\n    cursor: move;\n    pointer-events: auto;\n  }\n  .calculator-header .toggle-btn {\n    visibility: visible;\n  }\n}\n\n.calculator-content {\n  padding: 0 1rem 1.5rem;\n}\n\n.calculator-formula {\n  display: flex;\n  justify-content: end;\n  align-items: center;\n  height: 2rem;\n  margin: -0.3rem 0 0.3rem;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.calculator-display {\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: 2.8rem;\n  background: #eee;\n  border-radius: 4px;\n  padding: 0.5rem;\n  margin-bottom: 0.8rem;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.mat-grid-list {\n  margin: -0.2rem;\n}\n\n.mat-grid-tile {\n  overflow: visible;\n}\n\n.mat-mdc-raised-button {\n  font-size: 1.2rem;\n  min-width: 0;\n  width: 100%;\n  margin: 0.2rem;\n}\n\n.btn-text {\n  font-size: 1rem;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/app/tool/application/presentation/calculator/calculator.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{E:()=>CalculatorComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var calculator_componentngResource=__webpack_require__("./src/app/tool/application/presentation/calculator/calculator.component.scss?ngResource"),calculator_componentngResource_default=__webpack_require__.n(calculator_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs"),form_field=__webpack_require__("./node_modules/@angular/material/fesm2022/form-field.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),input=__webpack_require__("./node_modules/@angular/material/fesm2022/input.mjs"),card=__webpack_require__("./node_modules/@angular/material/fesm2022/card.mjs"),grid_list=__webpack_require__("./node_modules/@angular/material/fesm2022/grid-list.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs");let CalculatorComponent=class CalculatorComponent{displayElement;formulaElement;display=(0,core.signal)("");formula=(0,core.signal)("");isVisible=(0,core.signal)(!1);isDragging=(0,core.signal)(!1);position=(0,core.signal)({x:20,y:20});buttons=(0,core.signal)(BUTTONS);expression=(0,core.signal)([]);result=(0,core.signal)(0);resultDisplayed=(0,core.signal)(!1);dragOffset=(0,core.signal)({x:0,y:0});displayFontSize=(0,core.signal)(18);formulaFontSize=(0,core.signal)(14);displayValue=(0,core.computed)((()=>this.display()));formulaValue=(0,core.computed)((()=>this.formula()));constructor(){(0,core.effect)((()=>{const expressionValue=this.expression();this.display.set(this.getExpressionString(expressionValue))})),(0,core.effect)((()=>{const displayValue=this.display(),formulaValue=this.formula();(displayValue||formulaValue)&&setTimeout((()=>this.updateFontSize()),0)}))}toggleVisibility(){this.isVisible.update((visible=>!visible))}onMouseDown(event){if(event.target instanceof HTMLElement&&event.target.closest(".calculator-header")){this.isDragging.set(!0);const rect=event.currentTarget.getBoundingClientRect();this.dragOffset.set({x:event.clientX-rect.left,y:event.clientY-rect.top}),event.preventDefault()}}onMouseMove(event){if(this.isDragging()){const offset=this.dragOffset();this.position.set({x:event.clientX-offset.x,y:event.clientY-offset.y})}}onMouseUp(){this.isDragging.set(!1)}onButtonClick(value){switch(value){case"Clear":this.clear();break;case"Del":this.deleteOne();break;case"=":this.execute();break;default:this.write(value)}}write(item){const currentExpression=this.expression();if(this.resultDisplayed()&&this.isNumber(item))this.expression.set([item]);else if(this.isNumber(item))this.expression.set([...currentExpression,item]);else if(this.isOperator(item))if(0===currentExpression.length)"-"===item&&this.expression.set([item]);else{const lastItem=currentExpression[currentExpression.length-1];if(this.isNumber(lastItem)||"."===lastItem)this.expression.set([...currentExpression,item]);else if(this.isOperator(lastItem))if("-"===item)this.expression.set([...currentExpression,item]);else{const newExpression=[...currentExpression];newExpression[newExpression.length-1]=item,this.expression.set(newExpression)}}else"."===item?currentExpression.length>0&&this.isNumber(currentExpression[currentExpression.length-1])&&this.expression.set([...currentExpression,item]):"frac"===item&&currentExpression.length>0&&this.isNumber(currentExpression[currentExpression.length-1])&&this.expression.set([...currentExpression,item]);this.resultDisplayed.set(!1)}execute(){const currentDisplay=this.display();if(currentDisplay&&""!==currentDisplay)try{const expressionString=this.expression().join("").replace(/frac/g,"/"),calculatedResult=this.evaluateExpression(expressionString);isNaN(calculatedResult)?(this.result.set(0),this.formula.set(currentDisplay),this.display.set("NaN"),this.expression.set([]),this.resultDisplayed.set(!1)):(this.result.set(calculatedResult),this.formula.set(currentDisplay+"="),this.expression.set([calculatedResult.toString()]),this.resultDisplayed.set(!0))}catch(e){console.error(e),this.result.set(0),this.formula.set(currentDisplay+"="),this.display.set("Error"),this.expression.set([]),this.resultDisplayed.set(!1)}}clear(){this.resultDisplayed.set(!1),this.result.set(0),this.display.set(""),this.formula.set(""),this.expression.set([])}deleteOne(){this.resultDisplayed.set(!1);const currentExpression=this.expression();this.expression.set(currentExpression.slice(0,-1))}getExpressionString(expression){let newExpression="",frac=!1;for(let i=0;i<expression.length;i++)if(frac&&this.isOperator(expression[i])&&(newExpression+="</sub></span>",frac=!1),"/"===expression[i])newExpression+="รท";else if("*"===expression[i])newExpression+="ร";else if("frac"===expression[i]){let fi=newExpression.length-1,foundDecimal=!1;for(;fi>=0;){const char=newExpression[fi];if(/\d/.test(char))fi--;else{if("."!==char||foundDecimal){if("-"===char&&0===fi)break;fi++;break}foundDecimal=!0,fi--}}fi=Math.max(0,fi),newExpression=[newExpression.slice(0,fi),'<span class="frac"><sup>',newExpression.slice(fi)].join(""),newExpression+="</sup><sub>",frac=!0}else newExpression+=expression[i];return frac&&(newExpression+="</sub></span>"),newExpression}isOperator(item){return"+"===item||"-"===item||"*"===item||"/"===item}isNumber(item){return!isNaN(Number(item))&&""!==item}evaluateExpression(expression){if(expression=expression.replace(/\s/g,""),!/^[\d+\-*/.()]+$/.test(expression))throw new Error("Invalid characters in expression");const tokens=this.tokenize(expression),postfix=this.infixToPostfix(tokens),result=this.evaluatePostfix(postfix),precisionComponent=Math.pow(10,5);return Math.round(result*precisionComponent)/precisionComponent}tokenize(expression){const tokens=[];let current="";for(let i=0;i<expression.length;i++){const char=expression[i];/\d/.test(char)||"."===char?current+=char:["+","*","/","(",")"].includes(char)?(current&&(tokens.push(current),current=""),tokens.push(char)):"-"===char&&(current?(tokens.push(current),current="",tokens.push(char)):0===tokens.length||this.isOperator(tokens[tokens.length-1])?current=char:tokens.push(char))}return current&&tokens.push(current),tokens}infixToPostfix(tokens){const output=[],operators=[],precedence={"+":1,"-":1,"*":2,"/":2};for(const token of tokens)if(/\d/.test(token)||token.startsWith("-")&&token.length>1)output.push(token);else if("("===token)operators.push(token);else if(")"===token){for(;operators.length>0&&"("!==operators[operators.length-1];)output.push(operators.pop());operators.length>0&&"("===operators[operators.length-1]&&operators.pop()}else{for(;operators.length>0&&"("!==operators[operators.length-1]&&precedence[operators[operators.length-1]]>=precedence[token];)output.push(operators.pop());operators.push(token)}for(;operators.length>0;)output.push(operators.pop());return output}evaluatePostfix(postfix){const stack=[];for(const token of postfix)if(/\d/.test(token)||token.startsWith("-")&&token.length>1)stack.push(parseFloat(token));else{const b=stack.pop(),a=stack.pop();switch(token){case"+":stack.push(a+b);break;case"-":stack.push(a-b);break;case"*":stack.push(a*b);break;case"/":if(0===b)throw new Error("Division by zero");stack.push(a/b)}}return stack[0]}updateFontSize(){if(!this.displayElement?.nativeElement||!this.formulaElement?.nativeElement)return;const displayElement=this.displayElement.nativeElement,formulaElement=this.formulaElement.nativeElement,displayContentWidth=displayElement.offsetWidth,formulaContentWidth=formulaElement.offsetWidth,displaySize=this.calculateFontSize(displayElement,displayContentWidth,18,10),formulaSize=this.calculateFontSize(formulaElement,formulaContentWidth,14,6);this.displayFontSize.set(displaySize),this.formulaFontSize.set(formulaSize)}calculateFontSize(element,containerWidth,maxFontSize,minFontSize){const originalFontSize=element.style.fontSize;element.style.fontSize=`${maxFontSize}px`;const contentWidthWithMaxFont=element.scrollWidth;element.style.fontSize=originalFontSize;const ratio=containerWidth/contentWidthWithMaxFont;let newFontSize=Math.floor(maxFontSize*ratio);return newFontSize=Math.max(minFontSize,Math.min(maxFontSize,newFontSize)),newFontSize}static ctorParameters=()=>[];static propDecorators={displayElement:[{type:core.ViewChild,args:["displayElement",{static:!1}]}],formulaElement:[{type:core.ViewChild,args:["formulaElement",{static:!1}]}],onMouseMove:[{type:core.HostListener,args:["document:mousemove",["$event"]]}],onMouseUp:[{type:core.HostListener,args:["document:mouseup"]}]}};CalculatorComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"app-tool-calculator",template:'<div\n  class="calculator-wrapper"\n  [class.visible]="isVisible()"\n  [style.left.px]="position().x"\n  [style.top.px]="position().y"\n>\n  <mat-card class="calculator">\n    <div class="calculator-header" (mousedown)="onMouseDown($event)">\n      <mat-icon color="accent">calculate</mat-icon>\n      <h3>Calculator</h3>\n      <button\n        mat-icon-button\n        class="toggle-btn"\n        (click)="toggleVisibility()"\n        [attr.aria-label]="isVisible() ? \'Hide calculator\' : \'Show calculator\'"\n      >\n        <mat-icon>{{ isVisible() ? "remove" : "add" }}</mat-icon>\n      </button>\n    </div>\n    <div class="calculator-content">\n      <div\n        class="calculator-formula"\n        #formulaElement\n        [innerHTML]="formula()"\n        [style.font-size.px]="formulaFontSize()"\n      ></div>\n      <div\n        class="calculator-display"\n        #displayElement\n        [innerHTML]="display()"\n        [style.font-size.px]="displayFontSize()"\n      ></div>\n      <mat-grid-list cols="4" rowHeight="2.625rem" gutterSize="0">\n        @for (btn of buttons(); track btn.value) {\n        <mat-grid-tile [colspan]="btn.colspan || 1">\n          <button\n            mat-raised-button\n            [color]="btn.color || \'primary\'"\n            [ngClass]="btn.class || \'\'"\n            (click)="onButtonClick(btn.value)"\n            [innerHTML]="btn.label || btn.value"\n            [attr.aria-label]="btn.ariaLabel"\n          ></button>\n        </mat-grid-tile>\n        }\n      </mat-grid-list>\n    </div>\n  </mat-card>\n</div>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,imports:[common.MD,card.Hu,grid_list.Fe,fesm2022_button.Hl,icon.m_,form_field.RG,input.fS],styles:[calculator_componentngResource_default()]})],CalculatorComponent);const BUTTONS=[{value:"7",ariaLabel:"Number 7"},{value:"8",ariaLabel:"Number 8"},{value:"9",ariaLabel:"Number 9"},{value:"/",ariaLabel:"Divide"},{value:"4",ariaLabel:"Number 4"},{value:"5",ariaLabel:"Number 5"},{value:"6",ariaLabel:"Number 6"},{value:"*",ariaLabel:"Multiply"},{value:"1",ariaLabel:"Number 1"},{value:"2",ariaLabel:"Number 2"},{value:"3",ariaLabel:"Number 3"},{value:"-",ariaLabel:"Minus"},{value:"0",ariaLabel:"Number 0"},{value:".",ariaLabel:"Decimal point"},{label:"<sup>x</sup><sub>y</sub>",value:"frac",color:"primary",class:"frac",ariaLabel:"Fraction"},{value:"+",ariaLabel:"Plus"},{value:"Clear",color:"warn",class:"btn-text",ariaLabel:"Clear all"},{value:"Del",color:"warn",class:"btn-text",ariaLabel:"Delete last character"},{value:"=",color:"accent",colspan:2,ariaLabel:"Equals"}]},"./src/stories/calculator/calculator.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/stories/calculator/calculator.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,__namedExportsOrder:()=>__namedExportsOrder,default:()=>calculator_stories});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),calculatorngResource=__webpack_require__("./src/stories/calculator/calculator.css?ngResource"),calculatorngResource_default=__webpack_require__.n(calculatorngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),calculator_component=__webpack_require__("./src/app/tool/application/presentation/calculator/calculator.component.ts");let CalculatorComponent=class CalculatorComponent{};CalculatorComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"storybook-calculator",standalone:!0,imports:[common.MD,calculator_component.E],template:"\n    <app-tool-calculator />\n  ",styles:[calculatorngResource_default()]})],CalculatorComponent);const calculator_stories={title:"Tool/Calculator",component:CalculatorComponent,parameters:{docs:{story:{height:"600px",inline:!1}}}},Primary={parameters:{docs:{story:{height:"600px",inline:!1}}}},__namedExportsOrder=["Primary"];Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:"{\n  parameters: {\n    docs: {\n      story: {\n        height: '600px',\n        inline: false\n      }\n    }\n  }\n}",...Primary.parameters?.docs?.source}}}}}]);